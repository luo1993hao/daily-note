### 写在前面
在加入新公司之前，完全不知道solr是什么，其实对搜索引擎这块都没有了解，包括现在市面上很红的es。以为solr是一个很落后的技术栈，
但是发现其实在不断的维护，并且有许多大公司使用，包括eBay,Ins。无奈的中文资料较少，搜到的文章也是一些断断续续的内容，很难去系统学习。
万幸找到了这本《solr权威指南》，通篇读下来，发现其实讲的比较全（后来发现书籍部分内容是汉化的官方文档）。读完写一下总结，让自己印象更深刻。
需要注意的是，这篇总结不会写的很详细，只会对solr概念，有那些功能，功能的原理进行描述。如果你想
深入学习solr，还需查询官方文档以及书籍。
### solr简单介绍
#### solr是什么
简单一句话，solr就是一个企业级搜索引擎。

对于使用者来说，就跟百度，谷歌包含的功能基本一致。
当然，"企业级"就意味着Solr具有高度可靠性、可扩展性 、 可容错性的特点，提供了分布式索引、索 引备份、查询负载均衡、 自动故障转移和恢复，以及集中配置等功能。
#### solr能做什么
对于使用者来说，搜索引擎就一个目的，让用户具有良好的用户体验。比如我们使用百度时，常见的搜索内容高亮，分页，当我们输入错误单词时候的拼写建议。
同样输入spring,音乐爱好者希望搜到的是spring相关的歌曲，而程序员是希望搜到的是spring框架的内容。
#### solr整体架构
这是官方提供的一个架构图。
![](https://s2.loli.net/2021/12/27/9DhpMUlECIx8Kt5.png)
一开始可能看不懂。我这里画了一张翻译图。只要记住一共就三大部分
- 数据导入。solr支持各种数据源的导入，包括数据库，pdf,xml等
- 数据查询。为了更好的用户体验，solr提供了不同的算法将用户输入进行分词
- 数据返回。支持各种数据类型的返回，包括xml.json,binary
### 详细介绍
#### 重要概念
- 域(filed)
  - 可以简单的类比于关系型字段的column
- document
  - 可以简单的类比为关系型数据库的table，但不同的是一个document的两条数据的字段可以完全不同。
  - 由多个域组成
- core
  - 可以简单的类比于关系型数据库的database，数据存放的地方。由许多document组成。
#### 重要的文件
- solr.xml
  - 主要用于配置 Core相关的管理参数设置， 比如 Core的加载线程数、 Core的根 目录、 Core的共享 lib 目录,zk host等，以及 SolrCloud的相关配置。
- solrconfig.xml
  - lucene版本配置
  - 索引创建相关配置，如索引目录
  - jmx配置
  - 缓存相关配置，缓存包括过滤器缓存 ，查询结果集缓存，
    Document缓存，以及自定
    义缓存等 ;
  - 缓存相关配置，缓存包括过滤器缓存 ，查询结果集缓存，
    Document缓存，以及自定
    义缓存等 ;
  - updateHandler 配置 即索引更新操作相关配置;
  - RequestHandler 相关配置 ，即接收客户端 HTTP 请求的处理类配置;
  - 查询组件配置如 HightLight, SpellChecker等等 ;
  - ResponseWriter配置即响应数据转换器相关配置，决定了晌应数据是以什么样格式返
    回给客户端的;
  - 自定义 ValueSourceParser配置，用来干预 Document 的权重、 评分，排序 。
- schema.xml
   - 用户输入的数据传递给 Solr, Solr会按照一定的模式去创建索引文挡 ，而模式规定了 每个索引文档包含的域，以及域的类型 、 采用什么分词器分词 等，这个模式就称为 Schema。
   - 相较于关系型数据库的schema来说，更为宽松一些，每个域不是必需的
   - 主要就是配置filed以及filedType.FieldType 指示了 Solr应该如何去解析 Field 以及 Field 是如何被查询的 。
   - 当你添加一个 Document, Solr从 Document 的 Field里提取信息，然后将这些信息添
     加到索引中 。 当你执行一个 Query (查询)， Solr可以快速查阅索引然后返回匹配到的文档 。
- data-config.xml
  - 用于使用 Solr DIH 从外部数据库导人数据
#### 分词
  分词就是将用户输入的一串文本分割成一个一个词，比如去除停用词 、特殊字符、标点符号和统一转 换成小写形式等 。 分词的准确与否，会直接影响搜索结果的相关度排序 。 从某种程度 上来 讲，分词算法的不同，都会影响页面的返回结果 。 因此，可以说分词是搜索的基础 。
#### 查询
- Query Parser是一个负责解析查询文本并将其转换成 Lucene里的 Query对象的组件。类似于orm框架中的sql解析器，例如在mybatis中，就好比将model以及xml输入转换为sql给db。
查询的整体流程图：
![](https://s2.loli.net/2021/12/28/NiafsD49zoILw1A.png)
### Solr admin
### solr http接口
solr 提供了各纬度的各个http接口，这里罗列一些常用的，具体使用方式
- core
  - 
- document