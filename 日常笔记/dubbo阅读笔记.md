

## dubbo需求

---

> - 服务越来越多-> url配置管理越来越难，硬件负载均衡器越来越大-> 需要一个注册中心，动态的注册和发现服务。
>- 服务之间依赖关系越来越复杂->需要自动的画出应用的依赖关系
>- 服务量越来越大->需要记录调用量，显示时间，调整权重。

---
这三点就是dubbo最基本的需求
### 细节知识
1. 注册中心，服务提供者，服务消费者三者之
间均为长连接
2. 数据库宕掉后，注册中心仍
能通过缓存提供服务列表查询，但不能注册新服务。

3.方法级优先，接口级次之，全局配置再次之。
如果级别一样，则消费方优先，提供方次之。

#### 配置读取的顺序
JVM启动-D参数优先，这样可以使用户在部署和启动时进行参数重写，比如在启动时需
改变协议的端口。
1. XML次之，如果在XML中有配置，则dubbo.properties中的相应配置项无效。
2. Properties最后，相当于缺省值，只有XML没有配置时，dubbo.properties的相应配置项
3. 才会生效，通常用于共享公共配置，比如应用名。
4. 扫描注解包路径，多个包用逗号分隔，不填pacakge表示扫描当前ApplicationContext中所有的类 
```
<dubbo:annotation package="com.foo.bar.service" />
```
5. 关闭所有服务的启动时检查：
没有提供者时报错
```
<dubbo:consumer check="false" />
```
6. 引用缺省是延迟初始化的，只有引用被注入到其它Bean，或被getBean()获取，才会初始化。
如果需要饥饿加载，即没有人引用也立即生成动态代理，可以配置：
```
<dubbo:reference interface="com.foo.BarService" init="true" />
```
7. 直连模式只适合开发及测试环境下
8. zk数据存储目录不能放在/temp中（默认，得改）,否则会引起数据丢失。

9. 不同服务不同协议。比如：不同服务在性能上适用不同协议进行传输，比如大数据用短连接协议，小数据大并发
用长连接协议 

10. 结果缓存，用于加速热门数据的访问速度，Dubbo提供声明式缓存，以减少用户加缓
存的工作量

11. 回声测试用于检测服务是否可用，回声测试按照正常请求流程执行，能够测试整个调
用是否通畅，可用于监控。

所有服务自动实现EchoService接口，只需将任意服务引用强制转型为EchoService，
即可使用。
```
<dubbo:reference id="memberService" interface="com.xxx.MemberService" />
MemberService memberService = ctx.getBean("memberService"); // 远程服务引用
EchoService echoService = (EchoService) memberService; // 强制转型为EchoService
String status = echoService.$echo("OK"); // 回声测试可用性
assert(status.equals("OK"));
```
12. 每次发生rpc调用，上下文都会变化
13. 隐射传参，用于框架集成，不建议使用
14. 本地调用：injvm，每个服务默认都会在本地暴露。在引用服务的时候，默认优先引用本地
服务
15. 一个接口有多种实现的时候，可以用group分组
16. 按组合并返回结果，比如菜单服务，接口一样，但有多种实现，用group区分，现在消
费方需从每种group中调用一次返回结果，合并结果返回，这样就可以实现聚合菜单项

---

### 猜测
启动时检查（check），集群容错（cluster），负载均衡（loadbalance）

---

### todolist
1.pdf文档21页，配置依赖关系图的完全理解
2. pdf文档33页，集群容错图流程的完全理解
3. pdf文档38页，线程模型再次阅读
4. 在开发及测试环境下，经常需要绕过注册中心？？
5. pdf文档63页，上下文信息再次阅读理解
6. pdf文档64页，参数回调
回调函数的通俗解释：

- 你到一个商店买东西，刚好你要的东西没有货，于是你在店员那里留下了你的电话，过了几天店里有货了，店员就打了你的电话，然后你接到电话后就到店里去取了货。在这个例子里，你的电话号码就叫**回调函数**，你把电话留给店员就叫**登记回调函数**，店里后来有货了叫做触发了回调关联的事件，店员给你打电话叫**做调用回调函数**，你到店里去取货叫做**响应回调事件**

作者：常溪玲
链接：https://www.zhihu.com/question/19801131/answer/13005983
来源：知乎
著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。
7. pdf 72页，**功能正交分解**？
